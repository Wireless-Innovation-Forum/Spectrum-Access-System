#    Copyright 2017 SAS Project Authors. All Rights Reserved.
#
#    Licensed under the Apache License, Version 2.0 (the "License");
#    you may not use this file except in compliance with the License.
#    You may obtain a copy of the License at
#
#        http://www.apache.org/licenses/LICENSE-2.0
#
#    Unless required by applicable law or agreed to in writing, software
#    distributed under the License is distributed on an "AS IS" BASIS,
#    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#    See the License for the specific language governing permissions and
#    limitations under the License.

"""Provides the expected list of NED/NLCD tiles.

This allows the NED and NLCD drivers to actually detect if there is an issue
when reading a tile (such as missing tile) and fail gracefully.

Also provides a simple statistic counter for tile hit analysis.
"""

import numpy as np


class TileStats(object):
  """Tile access statistics & analysis.
  """
  def __init__(self, type='ned'):
    """Initializes the tile accessor for type 'ned' or 'nlcd'."""
    self._tiles_set = NED_TILES if type == 'ned' else NLCD_TILES
    self.Reset()

  def UpdateForTileLoad(self, ilat, ilon):
    if (ilat, ilon) not in self._tiles_set:
      return
    self.tiles_stats[(ilat, ilon)] += 1

  def ActiveTilesCount(self):
    counts = [cnt for cnt in self.tiles_stats.values() if cnt > 0]
    num_active_tiles = len(counts)
    return (num_active_tiles, [0] if not counts else counts)

  def Reset(self):
    self.tiles_stats = {tile: 0 for tile in self._tiles_set}

  def Report(self):
    num_active_tiles, counts = self.ActiveTilesCount()
    print "Used tiles: {total} / {max}".format(
        total=num_active_tiles, max=len(self._tiles_set))
    print "Total load ops: {total}".format(
        total=sum(counts))
    print "Active tiles statistics (#loads per used tiles):"
    print "  Avg:{avg} (std={std})".format(
        avg=np.mean(counts), std=np.std(counts))
    print "  Min:{min} Max:{max}".format(
        min=np.min(counts), max=np.max(counts))


NED_TILES = set([
    ( 6, 162), (44, -81), (67,-165),
    ( 6, 163), (44, -82), (67,-166),
    ( 7, 134), (44, -83), (67,-167),
    ( 7, 151), (44, -84), (67,-168),
    ( 7, 152), (44, -88), (68,-139),
    ( 7, 158), (44, -89), (68,-140),
    ( 8, 134), (44, -90), (68,-141),
    ( 8, 151), (44, -91), (68,-142),
    ( 8, 152), (44, -92), (68,-159),
    ( 8, 158), (44, -93), (68,-160),
    ( 9, 134), (44, -98), (68,-161),
    (10, 138), (44, -99), (68,-162),
    (14, 144), (44,-100), (68,-163),
    (15, 145), (44,-101), (68,-164),
    (16, 145), (44,-102), (68,-165),
    (18, -65), (44,-103), (68,-166),
    (18, -66), (44,-104), (69,-139),
    (18, -67), (44,-105), (69,-140),
    (18, -68), (44,-106), (69,-141),
    (19, -65), (44,-107), (69,-142),
    (19, -66), (44,-108), (69,-159),
    (19, -67), (44,-109), (69,-160),
    (19, -68), (44,-110), (69,-161),
    (19,-156), (44,-112), (69,-162),
    (20,-155), (44,-113), (69,-163),
    (20,-156), (44,-114), (69,-164),
    (20,-157), (44,-115), (69,-165),
    (21,-156), (44,-116), (69,-166),
    (21,-157), (44,-117), (69,-167),
    (21,-158), (44,-119), (70,-139),
    (22,-157), (44,-120), (70,-140),
    (22,-158), (44,-121), (70,-154),
    (22,-159), (44,-122), (70,-155),
    (22,-160), (44,-123), (70,-156),
    (22,-161), (44,-124), (70,-157),
    (23,-160), (44,-125), (70,-158),
    (23,-161), (45, -60), (70,-159),
    (25, -81), (45, -62), (70,-160),
    (25, -82), (45, -63), (70,-161),
    (25, -83), (45, -64), (70,-162),
    (25, -98), (45, -65), (70,-163),
    (25, -99), (45, -66), (70,-164),
    (25,-100), (45, -67), (70,-165),
    (25,-101), (45, -68), (71,-152),
    (25,-102), (45, -78), (71,-153),
    (25,-103), (45, -79), (71,-154),
    (25,-104), (45, -80), (71,-155),
    (25,-105), (45, -81), (71,-156),
    (25,-106), (45, -82), (71,-157),
    (25,-107), (45, -83), (71,-158),
    (26, -81), (45, -84), (71,-159),
    (26, -82), (45, -85), (71,-160),
    (26, -98), (45, -87), (71,-161),
    (26, -99), (45, -88), (71,-162),
    (26,-100), (45, -89), (71,-163),
    (26,-101), (45, -90), (71,-164),
    (26,-102), (45, -91), (72,-155),
    (26,-103), (45, -92), (72,-156),
    (26,-104), (45, -98), (72,-157),
    (26,-105), (45, -99), (72,-158),
    (26,-106), (45,-100), (-14,-170),
    (26,-107), (45,-101), (-14,-171),
    (27, -83),  (45,-102),  (27, -81),
    (27, -98),  (45,-103),  (27, -82),
    (27, -99),  (45,-104),  (28, -81),
    (27,-100),  (45,-105),  (28, -82),
    (27,-101),  (45,-106),  (30, -83),
    (27,-102),  (45,-107),  (30, -84),
    (27,-103),  (45,-108),  (30, -89),
    (27,-104),  (45,-109),  (30, -90),
    (27,-105),  (45,-110),  (30, -91),
    (27,-106),  (45,-112),  (30, -92),
    (27,-107),  (45,-113),  (31, -84),
    (28, -83),  (45,-114),  (31, -86),
    (28, -97),  (45,-115),  (31, -87),
    (28, -98),  (45,-116),  (31, -88),
    (28, -99),  (45,-117),  (31, -89),
    (28,-100),  (45,-118),  (31, -90),
    (28,-101),  (45,-119),  (31, -91),
    (28,-102),  (45,-120),  (32, -86),
    (28,-103),  (45,-121),  (32, -87),
    (28,-104),  (45,-122),  (32, -88),
    (28,-105),  (45,-123),  (32, -89),
    (28,-106),  (45,-124),  (32, -90),
    (28,-107),  (45,-125),  (32, -91),
    (29, -81),  (46, -60),  (32, -98),
    (29, -82),  (46, -61),  (32,-106),
    (29, -83),  (46, -62),  (32,-107),
    (29, -90),  (46, -63),  (32,-110),
    (29, -96),  (46, -64),  (32,-111),
    (29, -97),  (46, -65),  (33, -87),
    (29, -98),  (46, -66),  (33, -89),
    (29, -99),  (46, -67),  (33, -90),
    (29,-100),  (46, -68),  (33, -91),
    (29,-101),  (46, -72),  (33, -98),
    (29,-102),  (46, -73),  (33, -99),
    (29,-103),  (46, -75),  (33,-100),
    (29,-104),  (46, -76),  (33,-101),
    (29,-105),  (46, -77),  (33,-107),
    (29,-106),  (46, -78),  (33,-115),
    (29,-107),  (46, -79),  (33,-116),
    (29,-108),  (46, -80),  (33,-117),
    (29,-109),  (46, -81),  (33,-118),
    (29,-110),  (46, -82),  (34, -81),
    (29,-111),  (46, -83),  (34, -82),
    (29,-112),  (46, -84),  (34, -83),
    (29,-113),  (46, -85),  (34, -87),
    (29,-114),  (46, -86),  (34, -88),
    (29,-115),  (46, -87),  (34, -90),
    (30, -81),  (46, -88),  (34, -91),
    (30, -82),  (46, -89),  (34, -92),
    (30, -85),  (46, -90),  (34, -98),
    (30, -86),  (46, -91),  (34, -99),
    (30, -93),  (46, -92),  (34,-100),
    (30, -94),  (46, -98),  (34,-102),
    (30, -95),  (46, -99),  (34,-103),
    (30, -96),  (46,-100),  (34,-104),
    (30, -97),  (46,-101),  (34,-105),
    (30, -98),  (46,-102),  (34,-106),
    (30, -99),  (46,-103),  (34,-117),
    (30,-100),  (46,-104),  (34,-118),
    (30,-101),  (46,-105),  (35, -77),
    (30,-102),  (46,-106),  (35, -78),
    (30,-103),  (46,-107),  (35, -83),
    (30,-104),  (46,-109),  (35, -86),
    (30,-105),  (46,-110),  (35, -87),
    (30,-106),  (46,-111),  (35, -88),
    (30,-107),  (46,-112),  (35, -89),
    (30,-108),  (46,-113),  (35, -90),
    (30,-109),  (46,-118),  (35, -91),
    (30,-110),  (46,-119),  (35, -92),
    (30,-111),  (46,-120),  (35, -93),
    (30,-112),  (46,-121),  (35, -94),
    (30,-113),  (46,-122),  (35, -98),
    (30,-114),  (46,-123),  (35, -99),
    (30,-115),  (46,-124),  (35,-104),
    (30,-116),  (46,-125),  (35,-106),
    (31, -82),  (47, -53),  (35,-107),
    (31, -83),  (47, -54),  (36, -76),
    (31, -85),  (47, -55),  (36, -77),
    (31, -92),  (47, -56),  (36, -78),
    (31, -93),  (47, -57),  (36, -84),
    (31, -94),  (47, -60),  (36, -85),
    (31, -95),  (47, -61),  (36, -89),
    (31, -96),  (47, -62),  (36, -90),
    (31, -97),  (47, -63),  (36, -91),
    (31, -98),  (47, -64),  (36, -92),
    (31, -99),  (47, -65),  (36, -93),
    (31,-100),  (47, -66),  (36, -94),
    (31,-101),  (47, -67),  (36, -95),
    (31,-102),  (47, -68),  (36, -97),
    (31,-103),  (47, -69),  (36, -98),
    (31,-104),  (47, -70),  (36, -99),
    (31,-105),  (47, -71),  (36,-106),
    (31,-106),  (47, -72),  (36,-107),
    (31,-107),  (47, -73),  (37, -76),
    (31,-108),  (47, -74),  (37, -77),
    (31,-109),  (47, -75),  (37, -78),
    (31,-110),  (47, -76),  (37, -83),
    (31,-111),  (47, -77),  (37, -84),
    (31,-112),  (47, -78),  (37, -87),
    (31,-113),  (47, -79),  (37, -88),
    (31,-114),  (47, -80),  (37, -89),
    (31,-115),  (47, -81),  (37, -90),
    (31,-116),  (47, -82),  (37, -91),
    (31,-117),  (47, -83),  (37, -92),
    (32, -81),  (47, -84),  (37, -94),
    (32, -82),  (47, -85),  (37, -95),
    (32, -83),  (47, -86),  (37, -96),
    (32, -84),  (47, -87),  (37, -97),
    (32, -85),  (47, -88),  (37, -98),
    (32, -92),  (47, -89),  (37, -99),
    (32, -93),  (47, -90),  (37,-100),
    (32, -94),  (47, -91),  (37,-101),
    (32, -95),  (47, -92),  (37,-106),
    (32, -96),  (47, -97),  (37,-107),
    (32, -97),  (47, -98),  (37,-108),
    (32, -99),  (47, -99),  (37,-109),
    (32,-100),  (47,-102),  (38, -76),
    (32,-101),  (47,-103),  (38, -77),
    (32,-102),  (47,-104),  (38, -78),
    (32,-103),  (47,-105),  (38, -79),
    (32,-104),  (47,-106),  (38, -83),
    (32,-105),  (47,-107),  (38, -84),
    (32,-108),  (47,-108),  (38, -87),
    (32,-109),  (47,-109),  (38, -88),
    (32,-112),  (47,-110),  (38, -89),
    (32,-113),  (47,-111),  (38, -90),
    (32,-114),  (47,-112),  (38, -91),
    (32,-115),  (47,-113),  (38, -92),
    (32,-116),  (47,-119),  (38, -95),
    (32,-117),  (47,-120),  (38, -96),
    (33, -80),  (47,-121),  (38, -97),
    (33, -81),  (47,-122),  (38, -98),
    (33, -82),  (47,-123),  (38, -99),
    (33, -83),  (47,-124),  (38,-100),
    (33, -84),  (47,-125),  (38,-101),
    (33, -85),  (48, -53),  (38,-108),
    (33, -86),  (48, -54),  (38,-109),
    (33, -88),  (48, -55),  (38,-113),
    (33, -92),  (48, -56),  (38,-114),
    (33, -93),  (48, -57),  (39, -76),
    (33, -94),  (48, -58),  (39, -77),
    (33, -95),  (48, -59),  (39, -78),
    (33, -96),  (48, -60),  (39, -79),
    (33, -97),  (48, -61),  (39, -80),
    (33,-102),  (48, -62),  (39, -85),
    (33,-103),  (48, -63),  (39, -86),
    (33,-104),  (48, -64),  (39, -87),
    (33,-105),  (48, -65),  (39, -88),
    (33,-106),  (48, -66),  (39, -89),
    (33,-108),  (48, -67),  (39, -90),
    (33,-109),  (48, -68),  (39, -91),
    (33,-110),  (48, -69),  (39, -93),
    (33,-111),  (48, -70),  (39, -95),
    (33,-112),  (48, -71),  (39, -96),
    (33,-113),  (48, -72),  (39, -97),
    (33,-114),  (48, -73),  (39, -98),
    (33,-119),  (48, -74),  (39, -99),
    (34, -78),  (48, -75),  (39,-100),
    (34, -79),  (48, -76),  (39,-101),
    (34, -80),  (48, -77),  (39,-124),
    (34, -84),  (48, -78),  (40, -75),
    (34, -85),  (48, -79),  (40, -76),
    (34, -86),  (48, -80),  (40, -77),
    (34, -89),  (48, -81),  (40, -78),
    (34, -93),  (48, -82),  (40, -79),
    (34, -94),  (48, -83),  (40, -80),
    (34, -95),  (48, -84),  (40, -85),
    (34, -96),  (48, -85),  (40, -86),
    (34, -97),  (48, -86),  (40, -87),
    (34,-101),  (48, -87),  (40, -88),
    (34,-107),  (48, -88),  (40, -89),
    (34,-108),  (48, -89),  (40, -90),
    (34,-109),  (48, -97),  (40, -91),
    (34,-110),  (48, -98),  (40, -92),
    (34,-111),  (48, -99),  (40, -93),
    (34,-112),  (48,-102),  (40, -94),
    (34,-113),  (48,-106),  (40, -95),
    (34,-114),  (48,-107),  (40, -96),
    (34,-115),  (48,-108),  (40, -97),
    (34,-116),  (48,-109),  (40, -99),
    (34,-119),  (48,-110),  (40,-100),
    (34,-120),  (48,-111),  (40,-101),
    (34,-121),  (48,-113),  (40,-105),
    (35, -76),  (48,-114),  (40,-106),
    (35, -79),  (48,-115),  (40,-112),
    (35, -80),  (48,-118),  (40,-124),
    (35, -81),  (48,-121),  (41, -73),
    (35, -82),  (48,-123),  (41, -74),
    (35, -84),  (49, -53),  (41, -75),
    (35, -85),  (49, -54),  (41, -76),
    (35, -95),  (49, -55),  (41, -77),
    (35, -96),  (49, -56),  (41, -78),
    (35, -97),  (49, -57),  (41, -85),
    (35,-100),  (49, -58),  (41, -86),
    (35,-101),  (49, -59),  (41, -87),
    (35,-102),  (49, -60),  (41, -88),
    (35,-103),  (49, -65),  (41, -89),
    (35,-105),  (49, -66),  (41, -90),
    (35,-108),  (49, -67),  (41, -91),
    (35,-109),  (49, -68),  (41, -92),
    (35,-110),  (49, -69),  (41, -93),
    (35,-111),  (49, -70),  (41, -94),
    (35,-112),  (49, -71),  (41, -95),
    (35,-113),  (49, -72),  (41, -96),
    (35,-114),  (49, -73),  (41, -99),
    (35,-115),  (49, -74),  (41,-100),
    (35,-116),  (49, -75),  (41,-101),
    (35,-117),  (49, -76),  (41,-103),
    (35,-118),  (49, -77),  (41,-104),
    (35,-119),  (49, -78),  (41,-105),
    (35,-120),  (49, -79),  (41,-106),
    (35,-121),  (49, -80),  (41,-112),
    (36, -79),  (49, -81),  (41,-113),
    (36, -80),  (49, -82),  (42, -72),
    (36, -81),  (49, -83),  (42, -73),
    (36, -82),  (49, -84),  (42, -74),
    (36, -83),  (49, -85),  (42, -75),
    (36, -86),  (49, -86),  (42, -85),
    (36, -87),  (49, -87),  (42, -86),
    (36, -88),  (49, -88),  (42, -87),
    (36, -96),  (49, -89),  (42, -88),
    (36,-100),  (49, -96),  (42, -89),
    (36,-101),  (49, -97),  (42, -90),
    (36,-102),  (49, -98),  (42, -91),
    (36,-103),  (49, -99),  (42, -92),
    (36,-104),  (49,-100),  (42,-103),
    (36,-105),  (49,-101),  (42,-112),
    (36,-108),  (49,-102),  (42,-113),
    (36,-109),  (49,-106),  (43, -72),
    (36,-110),  (49,-107),  (43, -73),
    (36,-111),  (49,-108),  (43, -74),
    (36,-112),  (49,-109),  (43, -75),
    (36,-113),  (49,-110),  (43, -77),
    (36,-114),  (49,-111),  (43, -78),
    (36,-115),  (49,-112),  (43, -80),
    (36,-116),  (49,-113),  (43, -89),
    (36,-117),  (49,-114),  (43, -90),
    (36,-118),  (49,-115),  (43, -91),
    (36,-119),  (49,-116),  (43,-113),
    (36,-120),  (49,-117),  (43,-118),
    (36,-121),  (49,-118),  (44, -70),
    (36,-122),  (49,-125),  (44, -71),
    (37, -79),  (49,-126),  (44, -72),
    (37, -80),  (50, -53),  (44, -73),
    (37, -81),  (50, -54),  (44, -74),
    (37, -82),  (50, -55),  (44, -76),
    (37, -85),  (50, -56),  (44, -77),
    (37, -86),  (50, -57),  (44, -78),
    (37, -93),  (50, -58),  (44, -79),
    (37,-102),  (50, -59),  (44, -85),
    (37,-103),  (50, -60),  (44, -86),
    (37,-104),  (50, -62),  (44, -87),
    (37,-105),  (50, -63),  (44, -94),
    (37,-110),  (50, -64),  (44, -95),
    (37,-111),  (50, -65),  (44, -96),
    (37,-112),  (50, -66),  (44, -97),
    (37,-113),  (50, -67),  (44,-111),
    (37,-114),  (50, -68),  (44,-118),
    (37,-115),  (50, -69),  (45, -69),
    (37,-116),  (50, -70),  (45, -70),
    (37,-117),  (50, -71),  (45, -71),
    (37,-118),  (50, -72),  (45, -72),
    (37,-119),  (50, -73),  (45, -73),
    (37,-120),  (50, -74),  (45, -74),
    (37,-121),  (50, -75),  (45, -75),
    (37,-122),  (50, -76),  (45, -76),
    (37,-123),  (50, -77),  (45, -77),
    (38, -80),  (50, -78),  (45, -86),
    (38, -81),  (50, -79),  (45, -93),
    (38, -82),  (50, -80),  (45, -94),
    (38, -85),  (50, -81),  (45, -95),
    (38, -86),  (50, -82),  (45, -96),
    (38, -93),  (50, -83),  (45, -97),
    (38, -94),  (50, -84),  (45,-111),
    (38,-102),  (50, -85),  (46, -69),
    (38,-103),  (50, -86),  (46, -70),
    (38,-104),  (50, -87),  (46, -71),
    (38,-105),  (50, -88),  (46, -74),
    (38,-106),  (50, -89),  (46, -93),
    (38,-107),  (50, -90),  (46, -94),
    (38,-110),  (50, -91),  (46, -95),
    (38,-111),  (50, -92),  (46, -96),
    (38,-112),  (50, -93),  (46, -97),
    (38,-115),  (50, -94),  (46,-108),
    (38,-116),  (50, -95),  (46,-114),
    (38,-117),  (50, -96),  (46,-115),
    (38,-118),  (50, -97),  (46,-116),
    (38,-119),  (50, -98),  (46,-117),
    (38,-120),  (50, -99),  (47, -93),
    (38,-121),  (50,-100),  (47, -94),
    (38,-122),  (50,-101),  (47, -95),
    (38,-123),  (50,-102),  (47, -96),
    (38,-124),  (50,-103),  (47,-100),
    (39, -75),  (50,-104),  (47,-101),
    (39, -81),  (50,-105),  (47,-114),
    (39, -82),  (50,-106),  (47,-115),
    (39, -83),  (50,-107),  (47,-116),
    (39, -84),  (50,-108),  (47,-117),
    (39, -92),  (50,-109),  (47,-118),
    (39, -94),  (50,-110),  (48, -90),
    (39,-102),  (50,-111),  (48, -91),
    (39,-103),  (50,-112),  (48, -92),
    (39,-104),  (50,-113),  (48, -93),
    (39,-105),  (50,-114),  (48, -94),
    (39,-106),  (50,-115),  (48, -95),
    (39,-107),  (50,-116),  (48, -96),
    (39,-108),  (50,-117),  (48,-100),
    (39,-109),  (50,-118),  (48,-101),
    (39,-110),  (50,-119),  (48,-103),
    (39,-111),  (50,-120),  (48,-104),
    (39,-112),  (50,-121),  (48,-105),
    (39,-113),  (50,-122),  (48,-112),
    (39,-114),  (50,-123),  (48,-116),
    (39,-115),  (50,-124),  (48,-117),
    (39,-116),  (50,-125),  (48,-119),
    (39,-117),  (50,-126),  (48,-120),
    (39,-118),  (50,-127),  (48,-122),
    (39,-119),  (50,-128),  (48,-124),
    (39,-120),  (51,-127),  (48,-125),
    (39,-121),  (51,-128),  (49, -90),
    (39,-122),  (51,-129),  (49, -91),
    (39,-123),  (51,-130),  (49, -92),
    (40, -81),  (52,-127),  (49, -93),
    (40, -82),  (52,-128),  (49, -94),
    (40, -83),  (52,-129),  (49, -95),
    (40, -84),  (52,-131),  (49,-103),
    (40, -98),  (52,-132),  (49,-104),
    (40,-102),  (53,-127),  (49,-105),
    (40,-103),  (53,-128),  (49,-119),
    (40,-104),  (53,-129),  (49,-120),
    (40,-107),  (53,-130),  (49,-121),
    (40,-108),  (53,-131),  (49,-122),
    (40,-109),  (53,-132),  (49,-123),
    (40,-110),  (53,-133),  (49,-124),
    (40,-111),  (54,-127),  (55,-133),
    (40,-113),  (54,-128),  (56,-132),
    (40,-114),  (54,-129),  (56,-133),
    (40,-115),  (54,-130),  (56,-134),
    (40,-116),  (54,-131),  (57,-132),
    (40,-117),  (54,-132),  (57,-133),
    (40,-118),  (54,-133),  (57,-134),
    (40,-119),  (54,-134),  (57,-135),
    (40,-120),  (55,-127),  (57,-136),
    (40,-121),  (55,-128),  (58,-134),
    (40,-122),  (55,-129),  (58,-135),
    (40,-123),  (55,-130),  (58,-136),
    (40,-125),  (55,-131),  (58,-137),
    (41, -79),  (55,-132),  (59,-134),
    (41, -80),  (55,-134),  (59,-135),
    (41, -81),  (56,-127),  (59,-136),
    (41, -82),  (56,-128),  (59,-137),
    (41, -83),  (56,-129),  (59,-138),
    (41, -84),  (56,-130),  (59,-139),
    (41, -97),  (56,-131),  (60,-135),
    (41, -98),  (57,-127),  (60,-136),
    (41,-102),  (57,-128),  (60,-137),
    (41,-107),  (57,-129),  (60,-138),
    (41,-108),  (57,-130),  (60,-139),
    (41,-109),  (57,-131),  (60,-140),
    (41,-110),  (58,-127),  (60,-141),
    (41,-111),  (58,-128),  (60,-142),
    (41,-114),  (58,-129),  (60,-143),
    (41,-115),  (58,-130),  (60,-145),
    (41,-116),  (58,-131),  (60,-149),
    (41,-117),  (58,-132),  (60,-150),
    (41,-118),  (58,-133),  (60,-151),
    (41,-119),  (59,-127),  (60,-162),
    (41,-120),  (59,-128),  (61,-140),
    (41,-121),  (59,-129),  (61,-141),
    (41,-122),  (59,-130),  (61,-142),
    (41,-123),  (59,-131),  (61,-143),
    (41,-124),  (59,-132),  (61,-144),
    (41,-125),  (59,-133),  (61,-145),
    (42, -70),  (60,-127),  (61,-146),
    (42, -71),  (60,-128),  (61,-149),
    (42, -76),  (60,-129),  (61,-150),
    (42, -77),  (60,-130),  (61,-151),
    (42, -78),  (60,-131),  (61,-153),
    (42, -79),  (60,-132),  (61,-161),
    (42, -80),  (60,-133),  (61,-162),
    (42, -81),  (60,-134),  (61,-163),
    (42, -82),  (60,-144),  (62,-142),
    (42, -83),  (60,-146),  (62,-143),
    (42, -84),  (60,-147),  (62,-144),
    (42, -93),  (61,-127),  (62,-145),
    (42, -94),  (61,-128),  (62,-146),
    (42, -95),  (61,-129),  (62,-147),
    (42, -96),  (61,-130),  (62,-148),
    (42, -97),  (61,-131),  (62,-152),
    (42, -98),  (61,-132),  (62,-153),
    (42, -99),  (61,-133),  (62,-161),
    (42,-100),  (61,-134),  (62,-162),
    (42,-101),  (61,-135),  (63,-142),
    (42,-102),  (61,-136),  (63,-143),
    (42,-104),  (61,-137),  (63,-144),
    (42,-105),  (61,-138),  (63,-145),
    (42,-106),  (61,-139),  (63,-146),
    (42,-107),  (62,-139),  (63,-148),
    (42,-108),  (62,-140),  (63,-152),
    (42,-109),  (62,-141),  (63,-153),
    (42,-110),  (62,-149),  (64,-162),
    (42,-111),  (62,-150),  (64,-163),
    (42,-114),  (62,-151),  (65,-148),
    (42,-115),  (63,-139),  (65,-149),
    (42,-116),  (63,-140),  (65,-150),
    (42,-117),  (63,-147),  (65,-151),
    (42,-118),  (63,-149),  (65,-152),
    (42,-119),  (63,-150),  (65,-153),
    (42,-120),  (63,-151),  (65,-158),
    (42,-121),  (64,-139),  (66,-148),
    (42,-122),  (64,-140),  (66,-149),
    (42,-123),  (64,-142),  (66,-150),
    (42,-124),  (64,-143),  (66,-151),
    (42,-125),  (64,-144),  (66,-152),
    (43, -71),  (64,-145),  (66,-153),
    (43, -76),  (64,-146),  (66,-154),
    (43, -79),  (64,-147),  (66,-155),
    (43, -81),  (64,-148),  (66,-156),
    (43, -82),  (64,-149),  (66,-157),
    (43, -83),  (64,-150),  (66,-158),
    (43, -84),  (64,-151),  (67,-148),
    (43, -85),  (64,-152),  (67,-149),
    (43, -86),  (64,-153),  (67,-150),
    (43, -87),  (64,-158),  (67,-151),
    (43, -88),  (64,-159),  (67,-152),
    (43, -92),  (64,-160),  (67,-153),
    (43, -93),  (64,-161),  (67,-154),
    (43, -94),  (65,-139),  (67,-155),
    (43, -95),  (65,-140),  (67,-156),
    (43, -96),  (65,-146),  (67,-157),
    (43, -97),  (65,-147),  (67,-158),
    (43, -98),  (65,-159),  (68,-148),
    (43, -99),  (65,-160),  (68,-149),
    (43,-100),  (65,-161),  (68,-150),
    (43,-101),  (65,-162),  (68,-151),
    (43,-102),  (65,-163),  (68,-152),
    (43,-103),  (65,-164),  (68,-153),
    (43,-104),  (65,-165),  (68,-154),
    (43,-105),  (65,-166),  (68,-155),
    (43,-106),  (65,-167),  (68,-156),
    (43,-107),  (66,-139),  (68,-157),
    (43,-108),  (66,-140),  (68,-158),
    (43,-109),  (66,-141),  (69,-148),
    (43,-110),  (66,-142),  (69,-149),
    (43,-111),  (66,-159),  (69,-150),
    (43,-112),  (66,-160),  (69,-151),
    (43,-114),  (66,-161),  (69,-152),
    (43,-115),  (66,-162),  (69,-153),
    (43,-116),  (66,-163),  (69,-154),
    (43,-117),  (66,-164),  (69,-155),
    (43,-119),  (66,-165),  (69,-156),
    (43,-120),  (66,-166),  (69,-157),
    (43,-121),  (66,-167),  (69,-158),
    (43,-122),  (66,-168),  (70,-148),
    (43,-123),  (66,-169),  (70,-149),
    (43,-124),  (67,-139),  (70,-150),
    (43,-125),  (67,-140),  (70,-151),
    (44, -60),  (67,-141),  (70,-152),
    (44, -61),  (67,-142),  (70,-153),
    (44, -65),  (67,-159),  (71,-148),
    (44, -66),  (67,-160),  (71,-149),
    (44, -67),  (67,-161),  (71,-150),
    (44, -69),  (67,-162),  (71,-151),
    (44, -75),  (67,-163),
    (44, -80),  (67,-164)]
)

NLCD_TILES = set([
    (25, -81),  (37,-106),  (43,-112),
    (25, -82),  (37,-107),  (43,-113),
    (25, -83),  (37,-108),  (43,-114),
    (26, -81),  (37,-109),  (43,-115),
    (26, -82),  (37,-110),  (43,-116),
    (26, -98),  (37,-111),  (43,-117),
    (27, -81),  (37,-112),  (43,-118),
    (27, -82),  (37,-113),  (43,-119),
    (27, -83),  (37,-114),  (43,-120),
    (27, -98),  (37,-115),  (43,-121),
    (27, -99),  (37,-116),  (43,-122),
    (27,-100),  (37,-117),  (43,-123),
    (28, -81),  (37,-118),  (43,-124),
    (28, -82),  (37,-119),  (43,-125),
    (28, -83),  (37,-120),  (44, -69),
    (28, -97),  (37,-121),  (44, -70),
    (28, -98),  (37,-122),  (44, -71),
    (28, -99),  (37,-123),  (44, -72),
    (28,-100),  (38, -76),  (44, -73),
    (29, -81),  (38, -77),  (44, -74),
    (29, -82),  (38, -78),  (44, -75),
    (29, -83),  (38, -79),  (44, -76),
    (29, -90),  (38, -80),  (44, -77),
    (29, -96),  (38, -81),  (44, -78),
    (29, -97),  (38, -82),  (44, -79),
    (29, -98),  (38, -83),  (44, -80),
    (29, -99),  (38, -84),  (44, -83),
    (29,-100),  (38, -85),  (44, -84),
    (29,-101),  (38, -86),  (44, -85),
    (29,-104),  (38, -87),  (44, -86),
    (30, -81),  (38, -88),  (44, -87),
    (30, -82),  (38, -89),  (44, -88),
    (30, -83),  (38, -90),  (44, -89),
    (30, -84),  (38, -91),  (44, -90),
    (30, -85),  (38, -92),  (44, -91),
    (30, -86),  (38, -93),  (44, -92),
    (30, -89),  (38, -94),  (44, -93),
    (30, -90),  (38, -95),  (44, -94),
    (30, -91),  (38, -96),  (44, -95),
    (30, -92),  (38, -97),  (44, -96),
    (30, -93),  (38, -98),  (44, -97),
    (30, -94),  (38, -99),  (44, -98),
    (30, -95),  (38,-100),  (44, -99),
    (30, -96),  (38,-101),  (44,-100),
    (30, -97),  (38,-102),  (44,-101),
    (30, -98),  (38,-103),  (44,-102),
    (30, -99),  (38,-104),  (44,-103),
    (30,-100),  (38,-105),  (44,-104),
    (30,-101),  (38,-106),  (44,-105),
    (30,-102),  (38,-107),  (44,-106),
    (30,-103),  (38,-108),  (44,-107),
    (30,-104),  (38,-109),  (44,-108),
    (30,-105),  (38,-110),  (44,-109),
    (31, -82),  (38,-111),  (44,-110),
    (31, -83),  (38,-112),  (44,-111),
    (31, -84),  (38,-113),  (44,-112),
    (31, -85),  (38,-114),  (44,-113),
    (31, -86),  (38,-115),  (44,-114),
    (31, -87),  (38,-116),  (44,-115),
    (31, -88),  (38,-117),  (44,-116),
    (31, -89),  (38,-118),  (44,-117),
    (31, -90),  (38,-119),  (44,-118),
    (31, -91),  (38,-120),  (44,-119),
    (31, -92),  (38,-121),  (44,-120),
    (31, -93),  (38,-122),  (44,-121),
    (31, -94),  (38,-123),  (44,-122),
    (31, -95),  (38,-124),  (44,-123),
    (31, -96),  (39, -75),  (44,-124),
    (31, -97),  (39, -76),  (44,-125),
    (31, -98),  (39, -77),  (45, -67),
    (31, -99),  (39, -78),  (45, -68),
    (31,-100),  (39, -79),  (45, -69),
    (31,-101),  (39, -80),  (45, -70),
    (31,-102),  (39, -81),  (45, -71),
    (31,-103),  (39, -82),  (45, -72),
    (31,-104),  (39, -83),  (45, -73),
    (31,-105),  (39, -84),  (45, -74),
    (31,-106),  (39, -85),  (45, -75),
    (32, -81),  (39, -86),  (45, -76),
    (32, -82),  (39, -87),  (45, -77),
    (32, -83),  (39, -88),  (45, -83),
    (32, -84),  (39, -89),  (45, -84),
    (32, -85),  (39, -90),  (45, -85),
    (32, -86),  (39, -91),  (45, -86),
    (32, -87),  (39, -92),  (45, -87),
    (32, -88),  (39, -93),  (45, -88),
    (32, -89),  (39, -94),  (45, -89),
    (32, -90),  (39, -95),  (45, -90),
    (32, -91),  (39, -96),  (45, -91),
    (32, -92),  (39, -97),  (45, -92),
    (32, -93),  (39, -98),  (45, -93),
    (32, -94),  (39, -99),  (45, -94),
    (32, -95),  (39,-100),  (45, -95),
    (32, -96),  (39,-101),  (45, -96),
    (32, -97),  (39,-102),  (45, -97),
    (32, -98),  (39,-103),  (45, -98),
    (32, -99),  (39,-104),  (45, -99),
    (32,-100),  (39,-105),  (45,-100),
    (32,-101),  (39,-106),  (45,-101),
    (32,-102),  (39,-107),  (45,-102),
    (32,-103),  (39,-108),  (45,-103),
    (32,-104),  (39,-109),  (45,-104),
    (32,-105),  (39,-110),  (45,-105),
    (32,-106),  (39,-111),  (45,-106),
    (32,-107),  (39,-112),  (45,-107),
    (32,-108),  (39,-113),  (45,-108),
    (32,-109),  (39,-114),  (45,-109),
    (32,-110),  (39,-115),  (45,-110),
    (32,-111),  (39,-116),  (45,-111),
    (32,-112),  (39,-117),  (45,-112),
    (32,-113),  (39,-118),  (45,-113),
    (32,-114),  (39,-119),  (45,-114),
    (33, -80),  (39,-120),  (45,-115),
    (33, -81),  (39,-121),  (45,-116),
    (33, -82),  (39,-122),  (45,-117),
    (33, -83),  (39,-123),  (45,-118),
    (33, -84),  (39,-124),  (45,-119),
    (33, -85),  (40, -75),  (45,-120),
    (33, -86),  (40, -76),  (45,-121),
    (33, -87),  (40, -77),  (45,-122),
    (33, -88),  (40, -78),  (45,-123),
    (33, -89),  (40, -79),  (45,-124),
    (33, -90),  (40, -80),  (45,-125),
    (33, -91),  (40, -81),  (46, -68),
    (33, -92),  (40, -82),  (46, -69),
    (33, -93),  (40, -83),  (46, -70),
    (33, -94),  (40, -84),  (46, -71),
    (33, -95),  (40, -85),  (46, -72),
    (33, -96),  (40, -86),  (46, -73),
    (33, -97),  (40, -87),  (46, -74),
    (33, -98),  (40, -88),  (46, -75),
    (33, -99),  (40, -89),  (46, -83),
    (33,-100),  (40, -90),  (46, -84),
    (33,-101),  (40, -91),  (46, -85),
    (33,-102),  (40, -92),  (46, -86),
    (33,-103),  (40, -93),  (46, -87),
    (33,-104),  (40, -94),  (46, -88),
    (33,-105),  (40, -95),  (46, -89),
    (33,-106),  (40, -96),  (46, -90),
    (33,-107),  (40, -97),  (46, -91),
    (33,-108),  (40, -98),  (46, -92),
    (33,-109),  (40, -99),  (46, -93),
    (33,-110),  (40,-100),  (46, -94),
    (33,-111),  (40,-101),  (46, -95),
    (33,-112),  (40,-102),  (46, -96),
    (33,-113),  (40,-103),  (46, -97),
    (33,-114),  (40,-104),  (46, -98),
    (33,-115),  (40,-105),  (46, -99),
    (33,-116),  (40,-106),  (46,-100),
    (33,-117),  (40,-107),  (46,-101),
    (33,-118),  (40,-108),  (46,-102),
    (33,-119),  (40,-109),  (46,-103),
    (34, -78),  (40,-110),  (46,-104),
    (34, -79),  (40,-111),  (46,-105),
    (34, -80),  (40,-112),  (46,-106),
    (34, -81),  (40,-113),  (46,-107),
    (34, -82),  (40,-114),  (46,-108),
    (34, -83),  (40,-115),  (46,-109),
    (34, -84),  (40,-116),  (46,-110),
    (34, -85),  (40,-117),  (46,-111),
    (34, -86),  (40,-118),  (46,-112),
    (34, -87),  (40,-119),  (46,-113),
    (34, -88),  (40,-120),  (46,-114),
    (34, -89),  (40,-121),  (46,-115),
    (34, -90),  (40,-122),  (46,-116),
    (34, -91),  (40,-123),  (46,-117),
    (34, -92),  (40,-124),  (46,-118),
    (34, -93),  (40,-125),  (46,-119),
    (34, -94),  (41, -73),  (46,-120),
    (34, -95),  (41, -74),  (46,-121),
    (34, -96),  (41, -75),  (46,-122),
    (34, -97),  (41, -76),  (46,-123),
    (34, -98),  (41, -77),  (46,-124),
    (34, -99),  (41, -78),  (46,-125),
    (34,-100),  (41, -79),  (47, -68),
    (34,-101),  (41, -80),  (47, -69),
    (34,-102),  (41, -81),  (47, -70),
    (34,-103),  (41, -82),  (47, -71),
    (34,-104),  (41, -83),  (47, -84),
    (34,-105),  (41, -84),  (47, -85),
    (34,-106),  (41, -85),  (47, -86),
    (34,-107),  (41, -86),  (47, -87),
    (34,-108),  (41, -87),  (47, -88),
    (34,-109),  (41, -88),  (47, -89),
    (34,-110),  (41, -89),  (47, -90),
    (34,-111),  (41, -90),  (47, -91),
    (34,-112),  (41, -91),  (47, -92),
    (34,-113),  (41, -92),  (47, -93),
    (34,-114),  (41, -93),  (47, -94),
    (34,-115),  (41, -94),  (47, -95),
    (34,-116),  (41, -95),  (47, -96),
    (34,-117),  (41, -96),  (47, -97),
    (34,-118),  (41, -97),  (47, -98),
    (34,-119),  (41, -98),  (47, -99),
    (34,-120),  (41, -99),  (47,-100),
    (34,-121),  (41,-100),  (47,-101),
    (35, -77),  (41,-101),  (47,-102),
    (35, -78),  (41,-102),  (47,-103),
    (35, -79),  (41,-103),  (47,-104),
    (35, -80),  (41,-104),  (47,-105),
    (35, -81),  (41,-105),  (47,-106),
    (35, -82),  (41,-106),  (47,-107),
    (35, -83),  (41,-107),  (47,-108),
    (35, -84),  (41,-108),  (47,-109),
    (35, -85),  (41,-109),  (47,-110),
    (35, -86),  (41,-110),  (47,-111),
    (35, -87),  (41,-111),  (47,-112),
    (35, -88),  (41,-112),  (47,-113),
    (35, -89),  (41,-113),  (47,-114),
    (35, -90),  (41,-114),  (47,-115),
    (35, -91),  (41,-115),  (47,-116),
    (35, -92),  (41,-116),  (47,-117),
    (35, -93),  (41,-117),  (47,-118),
    (35, -94),  (41,-118),  (47,-119),
    (35, -95),  (41,-119),  (47,-120),
    (35, -96),  (41,-120),  (47,-121),
    (35, -97),  (41,-121),  (47,-122),
    (35, -98),  (41,-122),  (47,-123),
    (35, -99),  (41,-123),  (47,-124),
    (35,-100),  (41,-124),  (47,-125),
    (35,-101),  (41,-125),  (48, -68),
    (35,-102),  (42, -70),  (48, -69),
    (35,-103),  (42, -71),  (48, -70),
    (35,-104),  (42, -72),  (48, -86),
    (35,-105),  (42, -73),  (48, -87),
    (35,-106),  (42, -74),  (48, -88),
    (35,-107),  (42, -75),  (48, -89),
    (35,-108),  (42, -76),  (48, -90),
    (35,-109),  (42, -77),  (48, -91),
    (35,-110),  (42, -78),  (48, -92),
    (35,-111),  (42, -79),  (48, -93),
    (35,-112),  (42, -80),  (48, -94),
    (35,-113),  (42, -81),  (48, -95),
    (35,-114),  (42, -82),  (48, -96),
    (35,-115),  (42, -83),  (48, -97),
    (35,-116),  (42, -84),  (48, -98),
    (35,-117),  (42, -85),  (48, -99),
    (35,-118),  (42, -86),  (48,-100),
    (35,-119),  (42, -87),  (48,-101),
    (35,-120),  (42, -88),  (48,-102),
    (35,-121),  (42, -89),  (48,-103),
    (36, -76),  (42, -90),  (48,-104),
    (36, -77),  (42, -91),  (48,-105),
    (36, -78),  (42, -92),  (48,-106),
    (36, -79),  (42, -93),  (48,-107),
    (36, -80),  (42, -94),  (48,-108),
    (36, -81),  (42, -95),  (48,-109),
    (36, -82),  (42, -96),  (48,-110),
    (36, -83),  (42, -97),  (48,-111),
    (36, -84),  (42, -98),  (48,-112),
    (36, -85),  (42, -99),  (48,-113),
    (36, -86),  (42,-100),  (48,-114),
    (36, -87),  (42,-101),  (48,-115),
    (36, -88),  (42,-102),  (48,-116),
    (36, -89),  (42,-103),  (48,-117),
    (36, -90),  (42,-104),  (48,-118),
    (36, -91),  (42,-105),  (48,-119),
    (36, -92),  (42,-106),  (48,-120),
    (36, -93),  (42,-107),  (48,-121),
    (36, -94),  (42,-108),  (48,-122),
    (36, -95),  (42,-109),  (48,-123),
    (36, -96),  (42,-110),  (48,-124),
    (36, -97),  (42,-111),  (48,-125),
    (36, -98),  (42,-112),  (49, -88),
    (36, -99),  (42,-113),  (49, -89),
    (36,-100),  (42,-114),  (49, -90),
    (36,-101),  (42,-115),  (49, -91),
    (36,-102),  (42,-116),  (49, -92),
    (36,-103),  (42,-117),  (49, -93),
    (36,-104),  (42,-118),  (49, -94),
    (36,-105),  (42,-119),  (49, -95),
    (36,-106),  (42,-120),  (49, -96),
    (36,-107),  (42,-121),  (49, -97),
    (36,-108),  (42,-122),  (49, -98),
    (36,-109),  (42,-123),  (49, -99),
    (36,-110),  (42,-124),  (49,-100),
    (36,-111),  (42,-125),  (49,-101),
    (36,-112),  (43, -71),  (49,-102),
    (36,-113),  (43, -72),  (49,-103),
    (36,-114),  (43, -73),  (49,-104),
    (36,-115),  (43, -74),  (49,-105),
    (36,-116),  (43, -75),  (49,-106),
    (36,-117),  (43, -76),  (49,-107),
    (36,-118),  (43, -77),  (49,-108),
    (36,-119),  (43, -78),  (49,-109),
    (36,-120),  (43, -79),  (49,-110),
    (36,-121),  (43, -80),  (49,-111),
    (36,-122),  (43, -81),  (49,-112),
    (37, -76),  (43, -82),  (49,-113),
    (37, -77),  (43, -83),  (49,-114),
    (37, -78),  (43, -84),  (49,-115),
    (37, -79),  (43, -85),  (49,-116),
    (37, -80),  (43, -86),  (49,-117),
    (37, -81),  (43, -87),  (49,-118),
    (37, -82),  (43, -88),  (49,-119),
    (37, -83),  (43, -89),  (49,-120),
    (37, -84),  (43, -90),  (49,-121),
    (37, -85),  (43, -91),  (49,-122),
    (37, -86),  (43, -92),  (49,-123),
    (37, -87),  (43, -93),  (49,-124),
    (37, -88),  (43, -94),  (49,-125),
    (37, -89),  (43, -95),  (50, -95),
    (37, -90),  (43, -96),  (50, -96),
    (37, -91),  (43, -97),  (50, -97),
    (37, -92),  (43, -98),  (50, -98),
    (37, -93),  (43, -99),  (50, -99),
    (37, -94),  (43,-100),  (50,-110),
    (37, -95),  (43,-101),  (50,-115),
    (37, -96),  (43,-102),  (50,-116),
    (37, -97),  (43,-103),  (50,-117),
    (37, -98),  (43,-104),  (50,-118),
    (37, -99),  (43,-105),  (50,-119),
    (37,-100),  (43,-106),  (50,-121),
    (37,-101),  (43,-107),  (50,-122),
    (37,-102),  (43,-108),  (50,-123),
    (37,-103),  (43,-109),  (50,-124),
    (37,-104),  (43,-110),
    (37,-105),  (43,-111)]
)
